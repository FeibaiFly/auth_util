package BindWhiteCard;

import GeJie.PoiUtil;
import GeJie.StringUtils;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class MainClass {
    public static void main(String[] args) {
        //统一id，学生卡id
        String matchingStr = "7104364996,2460145;7105328010,3067470;7105328012,3067903;7105328014,3067789;7105328016,3067773;7105328018,3067771;7105328020,3067433;7105328022,3067516;7105328026,3067774;7105328028,3067655;7105328029,3067858;7105328031,3067364;7105328032,3067406;7105328034,3067383;7105328036,3067780;7105328037,3067745;7105328042,3067654;7105328044,3067399;7105328046,3067860;7105328048,3067932;7105328050,3067938;7105328051,3067936;7105328052,3067725;7105328054,3067935;7105328056,3067934;7105328058,3067937;7105328060,3067943;7105328062,3067941;7105328064,3067939;7105328066,3067490;7105328068,3067495;7105328070,3067491;7105328072,3067484;7105328073,3067473;7105328075,3067481;7105328079,3067833;7105328081,3067831;7105328083,3067726;7105328085,3067747;7105328087,3067746;7105328089,3067915;7105328091,3067912;7105328093,3067923;7105328095,3067920;7105328097,3067901;7105328099,3067736;7105328101,3067823;7105328103,3067919;7105328105,3067748;7105328107,3067740;7105328109,3067737;7105328111,3067735;7105328113,3067733;7105328115,3067526;7105328117,3067787;7105328119,3067786;7105328121,3067577;7105328125,3067653;7105328127,3067609;7105328129,3067397;7105328131,3067914;7105328133,3067921;7105328135,3067928;7105328137,3067485;7105328138,3067926;7105328140,3067482;7105328142,3067583;7105328144,3067835;7105328146,3067706;7105328150,3067822;7105328152,3067368;7105328154,3067370;7105328160,3067925;7105328162,3067924;7105328165,3067392;7105328167,3067657;7105328169,3067660;7105328171,3067659;7105328173,3067658;7105328174,3067656;7105328176,3067661;7105328178,3067665;7105328180,3067664;7105328182,3067663;7105328184,3067927;7105328186,3067933;7105328188,3067931;7105328190,3067930;7105328194,3067849;7105328196,3067850;7105328198,3067848;7105328202,3067844;7105328204,3067859;7105328206,3067864;7105328208,3067624;7105328210,3067627;7105328212,3067631;7105328214,3067629;7105328216,3067628;7105328219,3067461;7105328221,3067466;7105328223,3067520;7105328225,3067428;7105328233,3067425;7105328241,3067620;7105328243,3067619;7105328245,3067617;7105328247,3067622;7105328249,3067626;7105328251,3067884;7105328253,3067889;7105328255,3067832;7105328257,3067828;7105328259,3067827;7105328261,3067839;7105328263,3067843;7105328265,3067840;7105328267,3067837;7105328273,3067741;7105328275,3067907;7105328277,3067918;7105328279,3067374;7105328281,3067750;7105328283,3067749;7105328285,3067515;7105328287,3067815;7105328289,3067814;7105328291,3067811;7105328293,3067813;7105328295,3067817;7105328298,3067818;7105328300,3067819;7105328302,3067477;7105328304,3067421;7105328306,3067427;7105328308,3067480;7105328310,3067412;7105328314,3067384;7105328316,3067712;7105328318,3067788;7105328320,3067816;7105328322,3067820;7105328324,3067825;7105328326,3067431;7105328327,3067429;7105328329,3067419;7105328330,3067714;7105328332,3067899;7105328334,3067824;7105328336,3067769;7105328338,3067430;7105328340,3067359;7105328342,3067372;7105328344,3067378;7105328346,3067366;7105328348,3067373;7105328351,3067424;7105328353,3067766;7105328354,3067662;7105328356,3067615;7105328358,3067618;7105328359,3067667;7105328361,3067621;7105328363,3067455;7105328365,3067460;7105328366,3067458;7105328368,3067452;7105328374,3067465;7105328376,3067456;7105328380,3067459;7105328382,3067464;7105328383,3067879;7105328384,3067957;7105328386,3067570;7105328387,3067783;7105328389,3067782;7105328391,3067781;7105328392,3067396;7105328394,3067414;7105328396,3067423;7105328398,3067426;7105328399,3067505;7105328401,3067510;7105328403,3067519;7105328405,3067512;7105328407,3067507;7105328408,3067509;7105328410,3067518;7105328412,3067527;7105328414,3067809;7105328416,3067684;7105328418,3067696;7105328420,3067705;7105328422,3067703;7105328424,3067692;7105328425,3067694;7105328430,3067611;7105328431,3067784;7105328433,3067806;7105328439,3067511;7105328441,3067508;7105328443,3067503;7105328445,3067369;7105328447,3067418;7105328450,3067956;7105328452,3067768;7105328456,3067644;7105328457,3067719;7105328459,3067955;7105328469,3067567;7105328470,3067422;7105328472,3067377;7105328476,3067371;7105328477,3067666;7105328479,3067668;7105328481,3067673;7105328482,3067642;7105328484,3067643;7105328486,3067649;7105328488,3067648;7105328490,3067358;7105328492,3067808;7105328501,3067608;7105328503,3067450;7105328505,3067573;7105328507,3067571;7105328508,3067650;7105328510,3067877;7105328512,3067566;7105328514,3067647;7105328515,3067468;7105328519,3067709;7105328521,3067502;7105328523,3067605;7105328525,3067790;7105328527,3067554;7105328529,3067547;7105328531,3067548;7105328533,3067556;7105328534,3067563;7105328536,3067488;7105328538,3067492;7105328540,3067500;7105328542,3067775;7105328544,3067772;7105328546,3067742;7105328548,3067744;7105328550,3067765;7105328552,3067764;7105328554,3067763;7105328556,3067437;7105328558,3067348;7105328560,3067361;7105328561,3067436;7105328563,3067347;7105328565,3067499;7105328567,3067494;7105328569,3067493;7105328570,3067496;7105328571,3067506;7105328573,3067504;7105328575,3067804;7105328577,3067681;7105328579,3067680;7105328581,3067677;7105328583,3067678;7105328585,3067686;7105328586,3067690;7105328588,3067689;7105328592,3067801;7105328596,3067498;7105328598,3067870;7105328602,3067388;7105328604,3067803;7105328605,3067867;7105328607,3067953;7105328609,3067866;7105328613,3067676;7105328615,3067895;7105328619,3067892;7105328621,3067883;7105328623,3067560;7105328626,3067552;7105328628,3067606;7105328630,3067637;7105328631,3067559;7105328633,3067501;7105328637,3067469;7105328639,3067950;7105328641,3067478;7105328645,3067670;7105328647,3067878;7105328649,3067949;7105328653,3067538;7105328659,3067761;7105328660,3067762;7105328661,3067770;7105328663,3067767;7105328664,3067758;7105328666,3067760;7105328668,3067759;7105328680,3067640;7105328682,3067882;7105328684,3067897;7105328686,3067893;7105328688,3067793;7105328692,3067540;7105328695,3067551;7105328697,3067435;7105328703,3067449;7105328705,3067757;7105328709,3067799;7105328711,3067776;7105328717,3067947;7105328719,3067376;7105328720,3067411;7105328722,3067641;7105328724,3067853;7105328728,3067672;7105328732,3067487;7105328734,3067489;7105328736,3067486;7105328738,3067479;7105328740,3067945;7105328742,3067944;7105328744,3067451;7105328746,3067447;7105328748,3067443;7105328750,3067448;7105328752,3067454;7105328754,3067457;7105328756,3067345;7105328759,3067613;7105328761,3067616;7105328763,3067614;7105328765,3067612;7105328767,3067593;7105328769,3067590;7105328771,3067594;7105328773,3067432;7105328775,3067909;7105328776,3067946;7105328780,3067597;7105328782,3067375;7105328784,3067532;7105328788,3067405;7105328790,3067474;7105328792,3067635;7105328794,3067779;7105328796,3067434;7105328798,3067679;7105328800,3067542;7105328802,3067550;7105328803,3067543;7105328805,3067869;7105328807,3067592;7105328809,3067603;7105328814,3067797;7105328816,3067796;7105328817,3067798;7105328818,3067802;7105328820,3067805;7105328822,3067911;7105328824,3067785;7105328826,3067476;7105328877,3067394;7105328879,3067387;7105328881,3067754;7105328883,3067360;7105328885,3067753;7105328887,3067755;7105328889,3067752;7105328891,3067795;7105328893,3067794;7105328895,3067890;7105328897,3067792;7105328899,3067530;7105328901,3067523;7105328903,3067528;7105328905,3067886;7105328907,3067533;7105328909,3067544;7105328911,3067536;7105328913,3067751;7105328915,3067463;7105328917,3067472;7105328921,3067778;7105328923,3067791;7105328927,3067913;7105328942,3068170;7105328983,3067576;7105328985,3067885;7105328987,3067966;7105328989,3067682;7105328991,3067723;7105328993,3068198;7105328995,3068199;7105328997,3068212;7105328999,3068206;7105329001,3068210;7105329003,3068203;7105329005,3068204;7105329007,3068181;7105329009,3068178;7105329011,3068236;7105329013,3068235;7105329015,3068243;7105329019,3068244;7105329021,3068241;7105329023,3068240;7105329025,3067524;7105329027,3067979;7105329029,3068179;7105329031,3068162;7105329033,3068156;7105329035,3068152;7105329037,3068150;7105329039,3068149;7105329041,3068161;7105329043,3068256;7105329045,3068262;7105329047,3068264;7105329049,3068265;7105329051,3068261;7105329053,3067838;7105329055,3067688;7105329057,3067732;7105329058,3067905;7105329060,3067845;7105329062,3067908;7105329063,3067963;7105329065,3067872;7105329067,3067855;7105329071,3068197;7105329073,3068200;7105329077,3068194;7105329079,3068207;7105329080,3068202;7105329081,3068097;7105329082,3068205;7105329084,3067951;7105329085,3067830;7105329087,3068228;7105329089,3067900;7105329091,3067549;7105329093,3068064;7105329096,3068028;7105329098,3068026;7105329100,3068025;7105329102,3067545;7105329104,3067521;7105329106,3067568;7105329108,3067734;7105329110,3067693;7105329111,3067541;7105329113,3067539;7105329115,3067698;7105329116,3067717;7105329118,3067729;7105329120,3067994;7105329122,3067894;7105329124,3067958;7105329126,3068146;7105329128,3068277;7105329130,3067529;7105329132,3068022;7105329134,3067354;7105329136,3068113;7105329138,3068237;7105329140,3067976;7105329142,3067857;7105329144,3068008;7105329146,3068007;7105329148,3067381;7105329150,3068041;7105329152,3068278;7105329154,3068095;7105329156,3068080;7105329158,3068101;7105329160,3068093;7105329162,3068092;7105329163,3068089;7105329165,3068085;7105329167,3068105;7105329169,3068098;7105329171,3068273;7105329173,3214847;7105329175,3068271;7105329177,3068272;7105329179,3068276;7105329181,3068279;7105329183,3068280;7105329185,3068223;7105329187,3068221;7105329189,3068220;7105329191,3068222;7105329193,3068229;7105329195,3068062;7105329197,3068060;7105329199,3068059;7105329201,3068075;7105329203,3068068;7105329205,3068067;7105329207,3068195;7105329209,3068188;7105329210,3068100;7105329211,3068157;7105329213,3068120;7105329215,3068189;7105329217,3068106;7105329219,3068145;7105329221,3068183;7105329222,3067409;7105329225,3067836;7105329227,3067862;7105329229,3067865;7105329231,3068231;7105329232,3068053;7105329233,3068169;7105329235,3067974;7105329237,3067721;7105329239,3068184;7105329241,3068309;7105329245,3067973;7105329247,3068196;7105329249,3068258;7105329250,3067989;7105329252,3067390;7105329255,3068192;7105329257,3067713;7105329259,3068144;7105329261,3067700;7105329263,3068084;7105329265,3068063;7105329267,3068165;7105329269,3068163;7105329270,3068173;7105329272,3068176;7105329274,3067535;7105329276,3067352;7105329278,3067881;7105329280,3067357;7105329282,3067557;7105329284,3067356;7105329286,3067343;7105329288,3067558;7105329290,3067379;7105329292,3067367;7105329294,3067517;7105329296,3067962;7105329298,3067699;7105329300,3067724;7105329302,3067404;7105329304,3068259;7105329306,3068255;7105329308,3067346;7105329310,3068174;7105329312,3068238;7105329314,3068311;7105329315,3068260;7105329317,3068263;7105329319,3068269;7105329321,3068270;7105329323,3068267;7105329325,3068266;7105329327,3068268;7105329328,3068274;7105329329,3067363;7105329331,3067739;7105329333,3067876;7105329335,3067871;7105329337,3067402;7105329339,3067514;7105329341,3067854;7105329343,3067398;7105329345,3067861;7105329347,3068310;7105329349,3068177;7105329351,3068061;7105329352,3068108;7105329356,3067362;7105329358,3067687;7105329359,3068234;7105329361,3068180;7105329363,3068135;7105329365,3068132;7105329368,3068191;7105329370,3067417;7105329374,3068190;7105329376,3068230;7105329380,3067391;7105329382,3068107;7105329384,3068168;7105329386,3067985;7105329389,3068003;7105329391,3068076;7105329395,3068171;7105329396,3068052;7105329398,3068050;7105329400,3067846;7105329402,3068257;7105329409,3068066;7105329411,3067888;7105329413,3067880;7105329415,3067891;7105329419,3067522;7105329428,3068058;7105329430,3068057;7105329432,3068088;7105329434,3067353;7105329436,3068055;7105329438,3068087;7105329440,3067965;7105329442,3067852;7105329444,3067841;7105329446,3068299;7105329448,3068297;7105329450,3068298;7105329452,3068303;7105329454,3068306;7105329456,3068305;7105329458,3068302;7105329460,3068304;7105329462,3067561;7105329463,3067704;7105329465,3067553;7105329467,3067555;7105329469,3067685;7105329471,3068014;7105329473,3068011;7105329475,3068010;7105329477,3068182;7105329481,3068039;7105329483,3068056;7105329485,3068048;7105329487,3068047;7105329489,3068045;7105329491,3068219;7105329493,3068218;7105329497,3067382;7105329499,3068251;7105329501,3067961;7105329503,3068233;7105329505,3067710;7105329507,3068044;7105329509,3068006;7105329511,3068029;7105329513,3068077;7105329514,3068074;7105329516,3068071;7105329518,3068091;7105329520,3068083;7105329522,3068082;7105329526,3068185;7105329528,3068216;7105329530,3068215;7105329532,3068217;7105329534,3068141;7105329536,3068118;7105329538,3068117;7105329540,3068131;7105329542,3068130;7105329544,3068127;7105329546,3068124;7105329548,3068123;7105329550,3068137;7105329552,3068136;7105329554,3068213;7105329556,3068209;7105329558,3068208;7105329560,3068134;7105329562,3068128;7105329564,3068129;7105329566,3068140;7105329568,3068288;7105329570,3068291;7105329572,3067400;7105329574,3067988;7105329576,3067987;7105329578,3067986;7105329580,3067984;7105329582,3067982;7105329584,3067995;7105329586,3067992;7105329588,3067993;7105329590,3067990;7105329592,3068186;7105329603,3068294;7105329604,3068295;7105329606,3068292;7105329607,3068293;7105329609,3068296;7105329611,3068300;7105329613,3068017;7105329615,3068009;7105329616,3068211;7105329618,3068301;7105329620,3068245;7105329622,3068109;7105329624,3068073;7105329626,3068072;7105329628,3068133;7105329630,3067998;7105329632,3068125;7105329634,3068016;7105329636,3067863;7105329638,3067386;7105329640,3067711;7105329641,3067904;7105329643,3067537;7105329645,3068232;7105329646,3068069;7105329648,3068065;7105329650,3068086;7105329652,3068283;7105329654,3067970;7105329656,3067968;7105329658,3067959;7105329660,3067829;7105329662,3068033;7105329664,3067587;7105329665,3068078;7105329667,3068015;7105329669,3067874;7105329671,3067972;7105329673,3067393;7105329680,3068248;7105329683,3067349;7105329685,3068166;7105329687,3068164;7105329689,3068111;7105329691,3068103;7105329697,3068102;7105329699,3068099;7105329701,3068094;7105329703,3068115;7105329707,3067697;7105329709,3067971;7105329719,3068160;7105329721,3067738;7105329723,3068289;7105329725,3068290;7105329727,3068287;7105329729,3067380;7105329730,3067525;7105329745,3068139;7105329746,3068154;7105329750,3067579;7105329752,3067981;7105329753,3067969;7105329754,3067967;7105329756,3068158;7105329758,3067513;7105329760,3068281;7105329762,3067546;7105329764,3067564;7105329765,3068284;7105329768,3068110;7105329769,3068285;7105329773,3068214;7105329776,3068153;7105329778,3068119;7105329780,3067415;7105329782,3067977;7105329785,3068227;7105329787,3068138;7105329789,3067410;7105329793,3067727;7105329795,3068000;7105329797,3067960;7105329799,3067395;7105329801,3068116;7105329806,3068282;7105329808,3068226;7105329810,3067826;7105329812,3068114;7105329814,3068081;7105329815,3067695;7105329817,3067975;7105329819,3068104;7105329821,3068225;7105329823,3068036;7105329825,3067887;7105329827,3068249;7105329829,3068172;7105329831,3068155;7105329833,3068175;7105329835,3068247;7105329837,3068250;7105329839,3068246;7105329841,3067562;7105653378,3315556";
        //学生id，familyTelId
        String familyTelIdStr ="2460145,204057;3067343,204058;3067345,204060;3067346,204061;3067347,204062;3067348,204063;3067349,204064;3067352,204067;3067353,204068;3067354,204069;3067356,204071;3067357,204072;3067358,204073;3067359,204074;3067360,204075;3067361,204076;3067362,204077;3067363,204078;3067364,204079;3067366,204081;3067367,204082;3067368,204083;3067369,204084;3067370,204085;3067371,204086;3067372,204087;3067373,204088;3067374,204089;3067375,204090;3067376,204091;3067377,204092;3067378,204093;3067379,204094;3067380,204095;3067381,204096;3067382,204097;3067383,204098;3067384,204099;3067386,204101;3067387,204102;3067388,204103;3067390,204104;3067391,204105;3067392,204106;3067393,204107;3067394,204108;3067395,204109;3067396,204110;3067397,204111;3067398,204112;3067399,204113;3067400,204114;3067402,204116;3067404,204118;3067405,204119;3067406,204120;3067409,204123;3067410,204124;3067411,204125;3067412,204126;3067414,204128;3067415,204129;3067417,204131;3067418,204132;3067419,204133;3067421,204134;3067422,204135;3067423,204136;3067424,204137;3067425,204138;3067426,204139;3067427,204140;3067428,204141;3067429,204142;3067430,204143;3067431,204144;3067432,204145;3067433,204146;3067434,204147;3067435,204148;3067436,204149;3067437,204150;3067443,204156;3067447,204160;3067448,204161;3067449,204162;3067450,204163;3067451,204164;3067452,204165;3067454,204167;3067455,204168;3067456,204169;3067457,204170;3067458,204171;3067459,204172;3067460,204173;3067461,204174;3067463,204176;3067464,204177;3067465,204178;3067466,204179;3067468,204181;3067469,204182;3067470,204183;3067472,204185;3067473,204186;3067474,204187;3067476,204189;3067477,204190;3067478,204191;3067479,204192;3067480,204193;3067481,204194;3067482,204195;3067484,204197;3067485,204198;3067486,204199;3067487,204200;3067488,204201;3067489,204202;3067490,204203;3067491,204204;3067492,204205;3067493,204206;3067494,204207;3067495,204208;3067496,204209;3067498,204211;3067499,204212;3067500,204213;3067501,204214;3067502,204215;3067503,204216;3067504,204217;3067505,204218;3067506,204219;3067507,204220;3067508,204221;3067509,204222;3067510,204223;3067511,204224;3067512,204225;3067513,204226;3067514,204227;3067515,204228;3067516,204229;3067517,204230;3067518,204231;3067519,204232;3067520,204233;3067521,204234;3067522,204235;3067523,204236;3067524,204237;3067525,204238;3067526,204239;3067527,204240;3067528,204241;3067529,204242;3067530,204243;3067532,204245;3067533,204246;3067535,204248;3067536,204249;3067537,204250;3067538,204251;3067539,204252;3067540,204253;3067541,204254;3067542,204255;3067543,204256;3067544,204257;3067545,204258;3067546,204259;3067547,204260;3067548,204261;3067549,204262;3067550,204263;3067551,204264;3067552,204265;3067553,204266;3067554,204267;3067555,204268;3067556,204269;3067557,204270;3067558,204271;3067559,204272;3067560,204273;3067561,204274;3067562,204275;3067563,204276;3067564,204277;3067566,204279;3067567,204280;3067568,204281;3067570,204282;3067571,204283;3067573,204285;3067576,204288;3067577,204289;3067579,204291;3067583,204295;3067587,204299;3067590,204301;3067592,204303;3067593,204304;3067594,204305;3067597,204307;3067603,204313;3067605,204315;3067606,204316;3067608,204318;3067609,204319;3067611,204321;3067612,204322;3067613,204323;3067614,204324;3067615,204325;3067616,204326;3067617,204327;3067618,204328;3067619,204329;3067620,204330;3067621,204331;3067622,204332;3067624,204334;3067626,204336;3067627,204337;3067628,204338;3067629,204339;3067631,204341;3067635,204345;3067637,204347;3067640,204350;3067641,204351;3067642,204352;3067643,204353;3067644,204354;3067647,204357;3067648,204358;3067649,204359;3067650,204360;3067653,204363;3067654,204364;3067655,204365;3067656,204366;3067657,204367;3067658,204368;3067659,204369;3067660,204370;3067661,204371;3067662,204372;3067663,204373;3067664,204374;3067665,204375;3067666,204376;3067667,204377;3067668,204378;3067670,204380;3067672,204382;3067673,204383;3067676,204385;3067677,204386;3067678,204387;3067679,204388;3067680,204389;3067681,204390;3067682,204391;3067684,204393;3067685,204394;3067686,204395;3067687,204396;3067688,204397;3067689,204398;3067690,204399;3067692,204401;3067693,204402;3067694,204403;3067695,204404;3067696,204405;3067697,204406;3067698,204407;3067699,204408;3067700,204409;3067703,204412;3067704,204413;3067705,204414;3067706,204415;3067709,204418;3067710,204419;3067711,204420;3067712,204421;3067713,204422;3067714,204423;3067717,204426;3067719,204428;3067721,204430;3067723,204432;3067724,204433;3067725,204434;3067726,204435;3067727,204436;3067729,204438;3067732,204441;3067733,204442;3067734,204443;3067735,204444;3067736,204445;3067737,204446;3067738,204447;3067739,204448;3067740,204449;3067741,204450;3067742,204451;3067744,204453;3067745,204454;3067746,204455;3067747,204456;3067748,204457;3067749,204458;3067750,204459;3067751,204460;3067752,204461;3067753,204462;3067754,204463;3067755,204464;3067757,204466;3067758,204467;3067759,204468;3067760,204469;3067761,204470;3067762,204471;3067763,204472;3067764,204473;3067765,204474;3067766,204475;3067767,204476;3067768,204477;3067769,204478;3067770,204479;3067771,204480;3067772,204481;3067773,204482;3067774,204483;3067775,204484;3067776,204485;3067778,204487;3067779,204488;3067780,204489;3067781,204490;3067782,204491;3067783,204492;3067784,204493;3067785,204494;3067786,204495;3067787,204496;3067788,204497;3067789,204498;3067790,204499;3067791,204500;3067792,204501;3067793,204502;3067794,204503;3067795,204504;3067796,204505;3067797,204506;3067798,204507;3067799,204508;3067801,204510;3067802,204511;3067803,204512;3067804,204513;3067805,204514;3067806,204515;3067808,204517;3067809,204518;3067811,204520;3067813,204522;3067814,204523;3067815,204524;3067816,204525;3067817,204526;3067818,204527;3067819,204528;3067820,204529;3067822,204531;3067823,204532;3067824,204533;3067825,204534;3067826,204535;3067827,204536;3067828,204537;3067829,204538;3067830,204539;3067831,204540;3067832,204541;3067833,204542;3067835,204544;3067836,204545;3067837,204546;3067838,204547;3067839,204548;3067840,204549;3067841,204550;3067843,204552;3067844,204553;3067845,204554;3067846,204555;3067848,204556;3067849,204557;3067850,204558;3067852,204560;3067853,204561;3067854,204562;3067855,204563;3067857,204565;3067858,204566;3067859,204567;3067860,204568;3067861,204569;3067862,204570;3067863,204571;3067864,204572;3067865,204573;3067866,204574;3067867,204575;3067869,204577;3067870,204578;3067871,204579;3067872,204580;3067874,204582;3067876,204584;3067877,204585;3067878,204586;3067879,204587;3067880,204588;3067881,204589;3067882,204590;3067883,204591;3067884,204592;3067885,204593;3067886,204594;3067887,204595;3067888,204596;3067889,204597;3067890,204598;3067891,204599;3067892,204600;3067893,204601;3067894,204602;3067895,204603;3067897,204605;3067899,204607;3067900,204608;3067901,204609;3067903,204611;3067904,204612;3067905,204613;3067907,204615;3067908,204616;3067909,204617;3067911,204619;3067912,204620;3067913,204621;3067914,204622;3067915,204623;3067918,204626;3067919,204627;3067920,204628;3067921,204629;3067923,204631;3067924,204632;3067925,204633;3067926,204634;3067927,204635;3067928,204636;3067930,204638;3067931,204639;3067932,204640;3067933,204641;3067934,204642;3067935,204643;3067936,204644;3067937,204645;3067938,204646;3067939,204647;3067941,204649;3067943,204651;3067944,204652;3067945,204653;3067946,204654;3067947,204655;3067949,204657;3067950,204658;3067951,204659;3067953,204661;3067955,204663;3067956,204664;3067957,204665;3067958,204666;3067959,204667;3067960,204668;3067961,204669;3067962,204670;3067963,204671;3067965,204673;3067966,204674;3067967,204675;3067968,204676;3067969,204677;3067970,204678;3067971,204679;3067972,204680;3067973,204681;3067974,204682;3067975,204683;3067976,204684;3067977,204685;3067979,204687;3067981,204689;3067982,204690;3067984,204692;3067985,204693;3067986,204694;3067987,204695;3067988,204696;3067989,204697;3067990,204698;3067992,204700;3067993,204701;3067994,204702;3067995,204703;3067998,204706;3068000,204708;3068003,204711;3068006,204714;3068007,204715;3068008,204716;3068009,204717;3068010,204718;3068011,204719;3068014,204722;3068015,204723;3068016,204724;3068017,204725;3068022,204730;3068025,204733;3068026,204734;3068028,204736;3068029,204737;3068033,204741;3068036,204743;3068039,204746;3068041,204748;3068044,204751;3068045,204752;3068047,204753;3068048,204754;3068050,204756;3068052,204758;3068053,204759;3068055,204761;3068056,204762;3068057,204763;3068058,204764;3068059,204765;3068060,204766;3068061,204767;3068062,204768;3068063,204769;3068064,204770;3068065,204771;3068066,204772;3068067,204773;3068068,204774;3068069,204775;3068071,204777;3068072,204778;3068073,204779;3068074,204780;3068075,204781;3068076,204782;3068077,204783;3068078,204784;3068080,204786;3068081,204787;3068082,204788;3068083,204789;3068084,204790;3068085,204791;3068086,204792;3068087,204793;3068088,204794;3068089,204795;3068091,204797;3068092,204798;3068093,204799;3068094,204800;3068095,204801;3068097,204803;3068098,204804;3068099,204805;3068100,204806;3068101,204807;3068102,204808;3068103,204809;3068104,204810;3068105,204811;3068106,204812;3068107,204813;3068108,204814;3068109,204815;3068110,204816;3068111,204817;3068113,204819;3068114,204820;3068115,204821;3068116,204822;3068117,204823;3068118,204824;3068119,204825;3068120,204826;3068123,204829;3068124,204830;3068125,204831;3068127,204833;3068128,204834;3068129,204835;3068130,204836;3068131,204837;3068132,204838;3068133,204839;3068134,204840;3068135,204841;3068136,204842;3068137,204843;3068138,204844;3068139,204845;3068140,204846;3068141,204847;3068144,204850;3068145,204851;3068146,204852;3068149,204855;3068150,204856;3068152,204858;3068153,204859;3068154,204860;3068155,204861;3068156,204862;3068157,204863;3068158,204864;3068160,204866;3068161,204867;3068162,204868;3068163,204869;3068164,204870;3068165,204871;3068166,204872;3068168,204874;3068169,204875;3068170,204876;3068171,204877;3068172,204878;3068173,204879;3068174,204880;3068175,204881;3068176,204882;3068177,204883;3068178,204884;3068179,204885;3068180,204886;3068181,204887;3068182,204888;3068183,204889;3068184,204890;3068185,204891;3068186,204892;3068188,204894;3068189,204895;3068190,204896;3068191,204897;3068192,204898;3068194,204900;3068195,204901;3068196,204902;3068197,204903;3068198,204904;3068199,204905;3068200,204906;3068202,204908;3068203,204909;3068204,204910;3068205,204911;3068206,204912;3068207,204913;3068208,204914;3068209,204915;3068210,204916;3068211,204917;3068212,204918;3068213,204919;3068214,204920;3068215,204921;3068216,204922;3068217,204923;3068218,204924;3068219,204925;3068220,204926;3068221,204927;3068222,204928;3068223,204929;3068225,204931;3068226,204932;3068227,204933;3068228,204934;3068229,204935;3068230,204936;3068231,204937;3068232,204938;3068233,204939;3068234,204940;3068235,204941;3068236,204942;3068237,204943;3068238,204944;3068240,204946;3068241,204947;3068243,204949;3068244,204950;3068245,204951;3068246,204952;3068247,204953;3068248,204954;3068249,204955;3068250,204956;3068251,204957;3068255,204961;3068256,204962;3068257,204963;3068258,204964;3068259,204965;3068260,204966;3068261,204967;3068262,204968;3068263,204969;3068264,204970;3068265,204971;3068266,204972;3068267,204973;3068268,204974;3068269,204975;3068270,204976;3068271,204977;3068272,204978;3068273,204979;3068274,204980;3068276,204981;3068277,204982;3068278,204983;3068279,204984;3068280,204985;3068281,204986;3068282,204987;3068283,204988;3068284,204989;3068285,204990;3068287,204992;3068288,204993;3068289,204994;3068290,204995;3068291,204996;3068292,204997;3068293,204998;3068294,204999;3068295,205000;3068296,205001;3068297,205002;3068298,205003;3068299,205004;3068300,205005;3068301,205006;3068302,205007;3068303,205008;3068304,205009;3068305,205010;3068306,205011;3068309,205014;3068310,205015;3068311,205016;3214847,205029";

        String[] machingId = matchingStr.split(";");
        String[] familyTelIds = familyTelIdStr.split(";");
        Map<String,String> idMap = new HashMap<>();
        for(String id:machingId) {
            String[] s = id.split(",");
            idMap.put(s[0],s[1]);
        }

        Map<String,String> familTelIdMap = new HashMap<>();
        for(String id:familyTelIds) {
            String[] s = id.split(",");
            familTelIdMap.put(s[0],s[1]);
        }
        File file = new File("C:\\Users\\Administrator.USER-20200720VX\\Desktop\\割接学校\\白卡割接\\金塔县第四中学正确数据割接.xlsx");
        try {
            //newStudentId,newSchoolId,学校名称,班级,oldStudentId,studentName,parentName,家长号,rfid,imei,imeiPhone,亲情号名称,亲情号
            List<String[]> fileString = PoiUtil.readExcel(file, 8);
            fileString.remove(0);
            List<WhiteCard> cards = new ArrayList<WhiteCard>();
            StringBuffer sb = new StringBuffer("");
            StringBuffer notExistUser = new StringBuffer("");
            for(String[] s:fileString) {
                WhiteCard card = new WhiteCard();
                card.setPlatformUserId(s[0]);
                card.setCardNum(s[1]);
                List<String> tels = new ArrayList<>();
                tels.add(s[2]);
                tels.add(s[3]);
                tels.add(s[4]);
                tels.add(s[5]);
                tels.add(s[6]);
                card.setRelation(s[7]);


                if (idMap.containsKey(card.getPlatformUserId()) && StringUtils.isNoneBlank(card.getCardNum())) {
                  sb.append("update student set cardNum = '"+card.getCardNum()+"',send_time='2022-04-12 13:44:25' ,card_type=4 where id = "+idMap.get(card.getPlatformUserId())+";\r\n");
                  for(int i=0;i<tels.size();i++){
                      if(StringUtils.isNoneBlank(tels.get(i))) {
                          String id = familTelIdMap.get(idMap.get(card.getPlatformUserId()));
                          sb.append("INSERT INTO `hdkt_public_telephone_prod`.`family_phone_student_tel`(`student_id`, " +
                                  "`family_phone_no`, `family_phone`, `family_relation`) VALUES ("+id+
                                  ","+(i+1)+", '"+tels.get(i)+"', '"+card.getRelation()+"');\r\n");
                      }

                  }
                } else {
                    notExistUser.append(card.getPlatformUserId()+",");
                }

            }
            System.out.println(sb.toString());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
